{% extends "core.twig" %}
{% block title %}{{ _('Agents') }}{% endblock %}
{% block contentHeader %}
        {{ _('Agents') }}
        <small>{{ _('list') }}</small>
{% endblock %}
{% block content %}
<a class="btn btn-default btn-flat" href="{{ path_for('admin.agents.add') }}">
  <i class="fa fa-plus" aria-hidden="true"></i> {{ _('Add') }}
</a>
    {% for a in agents %}
<div class="modal fade modal-warning" id="delete{{ a.id }}" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{{ _('Delete agent') }}</h4>
      </div>
      <div class="modal-body">
	      <p>{{ _('Are you sure you want to delete this agent :') }}</p>
	      <p>{{ a.host }}</p>
      </div>
      <div class="modal-footer">
	<form action="{{ path_for('admin.agents.delete', { 'id': a.id }) }}" method="post">
          <button type="submit" class="btn btn-outline">{{ _('Confirm') }}</button>
	</form>
      </div>
    </div>
  </div>
</div>
    {% endfor %}
          <div class="box box-default">
            <div class="box-body table-responsive">
	      <table class="table table-striped table-hover" id="sort">
	      <thead><tr>
               <th class="sortable">{{ _('Host') }}</th>
               <th class="sortable">{{ _('Port') }}</th>
               <th class="sortable">{{ _('Use SSL') }}</th>
               <th class="sortable">{{ _('Frequency') }}</th>
               <th class="sortable">{{ _('Group') }}</th>
               <th class='text-right'>{{ _('Actions') }}</th>
	      </tr></thead><tbody>
	      </tbody>
	     </table>
            </div>
          </div>
{% endblock %}
{% block scripts %}
<script src="/js/watched.tables.js"></script>
<script>
  myTable = watchedTable("sort", [
    {% for a in agents %}
      {
	host:	{ "text": "{{ a.host }}", "url": "{{ path_for('admin.agents.change', { 'id': a.id }) }}"},
	port:	{ "text": "{{ a.port }}", "url": "{{ path_for('admin.agents.change', { 'id': a.id }) }}"},
	ssl:	{ "text": "{{ a.ssl  }}", "url": "{{ path_for('admin.agents.change', { 'id': a.id }) }}"},
	freq:	{ "text": "{{ a.pool_freq  }}", "url": "{{ path_for('admin.agents.change', { 'id': a.id }) }}"},
	cent:	{ "text": "{{ a.central_id }}", "url": "{{ path_for('admin.agents.change', { 'id': a.id }) }}"},
	actions: [ { icon:"fa fa-wrench", url: "{{ path_for('admin.agents.change', { 'id': a.id }) }}" },
		   { icon:"fa fa-trash",  target: "#delete{{ a.id }}" } ]
      },
    {% endfor %}
  ]);
</script>
{% endblock %}
